(this.webpackJsonpBidRating=this.webpackJsonpBidRating||[]).push([[0],{122:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(39),r=a.n(s),c=a(7),i=a.n(c),l=a(45),u=a(28),p=a.n(u),d=a(9),m=a(36),g=a(40),v=a.n(g),f=(a(71),a(29)),b=a.n(f),h=a(64),_=a.n(h),E=a(35),k=a.n(E),j=a(31),A=a.n(j),y=a(43),O=a.n(y),S=a(44),I=a.n(S),V=a(59),N=a.n(V),U=a(60),G=a.n(U),P=a(42),K=a.n(P),C=a(61),W=a.n(C),T=a(26),w=a.n(T),R=a(34),x=a.n(R),M=a(24),L=a.n(M),q=a(27),B=a.n(q),D=a(22),F=a.n(D),z=function(e){var t=e.idItem,a=e.first_name,n=e.last_name,s=e.avatar,r=e.price,c=e.pay,i="https://vk.com/id"+e.idVk;return o.a.createElement(L.a,{className:F.a.div},o.a.createElement("span",{className:F.a.listNumber},t),o.a.createElement(x.a,{className:F.a.listName,before:s?o.a.createElement(B.a,{src:s}):o.a.createElement(B.a,{src:"https://vk.com/images/camera_200.png"}),description:"\u0426\u0435\u043d\u0430: "+r+" \u0440\u0443\u0431",href:i},a?a+" "+n:"\u041c\u0435\u0441\u0442\u043e \u0434\u043b\u044f \u0442\u0435\u0431\u044f"),o.a.createElement(w.a,{id:t,className:F.a.button,level:"commerce",onClick:c},"\u0417\u0430\u043d\u044f\u0442\u044c \u043c\u0435\u0441\u0442\u043e"))},H=function(e){var t=e.idItem,a=e.avatar,n=e.price,s=e.name,r=e.go,c="https://vk.com/public"+e.idVkGroup;return o.a.createElement(L.a,{className:F.a.div},o.a.createElement("span",{className:F.a.listNumber},t),o.a.createElement(x.a,{className:F.a.listName,before:a?o.a.createElement(B.a,{src:a}):o.a.createElement(B.a,{src:"https://vk.com/images/camera_200.png"}),description:"\u0426\u0435\u043d\u0430: "+n+" \u0440\u0443\u0431",href:c},s||"\u041c\u0435\u0441\u0442\u043e \u0434\u043b\u044f \u0433\u0440\u0443\u043f\u043f\u044b"),o.a.createElement(w.a,{id:t,className:F.a.button,level:"commerce",onClick:r,"data-to":"vkpay"},"\u0417\u0430\u043d\u044f\u0442\u044c \u043c\u0435\u0441\u0442\u043e"))},J=function(e){var t=e.id,a=e.go,n=e.pay,s=e.tabUsers,r=e.tabGroups,c=e.activeTab,i=e.dataUsers,l=e.test,u=e.dataGroups,p=i.map((function(e){return o.a.createElement(z,{idItem:e.id,idVk:e.id_vk,avatar:e.avatar,price:e.price,pay:n,first_name:e.first_name,last_name:e.last_name,test:l})})),d=u.map((function(e){return o.a.createElement(H,{idItem:e.id,avatar:e.avatar,price:e.price,go:a,name:e.name,idVkGroup:e.id_group})}));return o.a.createElement(k.a,{id:t},o.a.createElement(A.a,null,"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043b\u0438\u0434\u0435\u0440\u043e\u0432"),o.a.createElement(N.a,{vertical:"top"},o.a.createElement(G.a,{theme:"header",type:"buttons"},o.a.createElement(W.a,null,o.a.createElement(K.a,{onClick:s,selected:"users"===c},"\u041b\u044e\u0434\u0438"),o.a.createElement(K.a,{onClick:r,selected:"groups"===c},"\u0421\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u0430")))),"users"===c?o.a.createElement(O.a,{title:"default",description:"\u041a\u0430\u0436\u0434\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u043f\u043e\u043a\u0443\u043f\u0430\u0435\u0442\u0441\u044f \u043d\u0430 14 \u0434\u043d\u0435\u0439.\u041f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u0439 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0439 \u043f\u043e\u043a\u0443\u043f\u043a\u0435 \u043c\u0435\u0441\u0442\u0430, \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 - 1,1 \u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f + 3 \u0434\u043d\u044f \u043a \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043f\u0440\u0435\u0431\u044b\u0432\u0430\u043d\u0438\u044f \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435."},o.a.createElement(I.a,null,p)):"","groups"===c?o.a.createElement(O.a,{title:"default",description:"\u041a\u0430\u0436\u0434\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u043f\u043e\u043a\u0443\u043f\u0430\u0435\u0442\u0441\u044f \u043d\u0430 14 \u0434\u043d\u0435\u0439.\u041f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u0439 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0439 \u043f\u043e\u043a\u0443\u043f\u043a\u0435 \u043c\u0435\u0441\u0442\u0430, \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 - 1,1 \u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f + 3 \u0434\u043d\u044f \u043a \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043f\u0440\u0435\u0431\u044b\u0432\u0430\u043d\u0438\u044f \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435. \u0412\u044b\u0448\u0435 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043c\u0435\u0441\u0442\u0430 - \u0434\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u0435\u0431\u044b\u0432\u0430\u043d\u0438\u044f \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435."},o.a.createElement(I.a,null,d)):"")},Q=a(63),X=a.n(Q),Y=a(62),Z=a.n(Y),$=a(41),ee=a.n($),te=function(e){var t=e.id,a=e.go,n=e.onChangeHandlerInput,s=e.reg,r=e.payGroups;return o.a.createElement(k.a,{id:t,theme:"white"},o.a.createElement(A.a,{left:o.a.createElement(ee.a,{onClick:a,"data-to":"list"})},"\u041e\u043f\u043b\u0430\u0442\u0430"),o.a.createElement(L.a,null,o.a.createElement(L.a,null,"\u041e\u043f\u043b\u0430\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 VK Pay"),o.a.createElement(Z.a,null,o.a.createElement(X.a,{top:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u0443",onChange:n,status:s?"valid":"error",bottom:s?"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u0443 \u0432\u0432\u0435\u0434\u0435\u043d\u0430 \u0432\u0435\u0440\u043d\u043e!":"\u0421\u0441\u044b\u043b\u043a\u0430 \u0432\u0432\u0435\u0434\u0435\u043d\u0430 \u043d\u0435\u0432\u0435\u0440\u043d\u043e"}),o.a.createElement(w.a,{size:"xl",onClick:r},"\u041e\u043f\u043b\u0430\u0442\u0438\u0442\u044c"))))};var ae=function(e){return"https://rating01.ru/api/"+e},ne=window.location.search.replace("?","").split("&").reduce((function(e,t){var a=t.split("=");return e[decodeURIComponent(a[0])]=decodeURIComponent(a[1]),e}),{});function oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,s=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString();if(void 0!==n||void 0!==o){var r=function(e){var t=e.detail;if(t){var a=t.type,c=t.data,l=!1;"VKWebAppCallAPIMethodResult"===a&&c.request_id===s?(void 0!==n&&n(c.response),l=!0):"VKWebAppCallAPIMethodFailed"===a&&c.request_id===s&&(void 0!==o&&o(c),l=!0),l&&i.a.unsubscribe(r)}else console.error("invalid event",e)};i.a.subscribe(r)}t.access_token=a,void 0===t.v&&(t.v=5.103),i.a.send("VKWebAppCallAPIMethod",{method:e,params:t,request_id:s})}b.a.defaults.params=Object(m.a)({},ne);var se=function(){var e=Object(n.useState)("list"),t=Object(d.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)(null),c=Object(d.a)(r,2),u=c[0],g=c[1],f=Object(n.useState)(!1),h=Object(d.a)(f,2),E=h[0],k=h[1],j=Object(n.useState)("users"),A=Object(d.a)(j,2),y=A[0],O=A[1],S=Object(n.useState)(""),I=Object(d.a)(S,2),V=I[0],N=I[1],U=Object(n.useState)([]),G=Object(d.a)(U,2),P=G[0],K=G[1],C=Object(n.useState)([]),W=Object(d.a)(C,2),T=W[0],w=W[1],R=Object(n.useState)(null),x=Object(d.a)(R,2),M=x[0],L=x[1],q=Object(n.useState)(!1),B=Object(d.a)(q,2),D=B[0],F=B[1],z=Object(n.useState)(0),H=Object(d.a)(z,2),Q=H[0],X=H[1],Y=Object(n.useState)(0),Z=Object(d.a)(Y,2),$=Z[0],ee=Z[1],ne=Object(n.useState)(o.a.createElement(_.a,{size:"large"})),se=Object(d.a)(ne,2),re=se[0],ce=se[1];function ie(e){e.preventDefault();var t=e.currentTarget.id-1,a=u.id,n=P[t].price;console.log("targetId: ",t),console.log("targetIdVk: ",a),console.log("dataUsers: ",P),i.a.sendPromise("VKWebAppOpenPayForm",{app_id:7217737,action:"pay-to-group",params:{amount:n,group_id:189804850}}).then((function(e){console.log("RES_USERS:",e),(e.status||e.result.status)&&(k(!0),console.log("\u041e\u041f\u041b\u0410\u0422\u0410 \u041f\u0420\u041e\u0428\u041b\u0410 1"),b.a.get(ae("list.updateUsersList"),{params:{id:t+1,id_vk:a}}).then((function(e){if(e.data.error)console.log(e.data.error);else{console.log("Id_Users_updateUsersList:",a),s("list"),console.log("\u041e\u041f\u041b\u0410\u0422\u0410 \u041f\u0420\u041e\u0428\u041b\u0410: 2",P);var n=Object(l.a)(P);n[t]=Object(m.a)({},n[t],{id_vk:u.id,first_name:u.first_name,last_name:u.last_name,avatar:u.photo_200}),K(n)}})).catch((function(e){console.log(e)}))),console.log(e.status)})).catch((function(e){console.log(e)}))}Object(n.useEffect)((function(){i.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;if("VKWebAppUpdateConfig"===a){var o=document.createAttribute("scheme");o.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(o)}})),i.a.sendPromise("VKWebAppStorageGet",{keys:["ActiveTab"]}).then((function(e){O(e.keys[0].value)})).catch((function(e){console.log(e)})),function(){var e,t;p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,p.a.awrap(i.a.sendPromise("VKWebAppGetUserInfo"));case 2:return e=a.sent,g(e),ce(null),a.next=7,p.a.awrap(i.a.sendPromise("VKWebAppGetAuthToken",{app_id:7217737,scope:""}));case 7:t=a.sent,L(t.access_token),P.length||b.a.get(ae("list.getUsers"),{}).then((function(e){if(e.data.error)console.log("\u041e\u0428\u0418\u0411\u041a\u0410 \u0414\u0410\u041d\u041d\u042b\u0425 USERS:",e.data.error);else{for(var a=[],n=0;n<e.data.response.items.length;n++)e.data.response.items[n].id_vk&&a.push(e.data.response.items[n].id_vk),console.log("arrUsers:",a);var o=[];oe("users.get",{user_ids:a.join(),fields:"photo_200"},t.access_token,(function(t){o=t,console.log(t);for(var a=function(t){var a=o.find((function(a){return+a.id===+e.data.response.items[t].id_vk}));console.log(a),a&&(e.data.response.items[t].first_name=a.first_name,e.data.response.items[t].last_name=a.last_name,e.data.response.items[t].avatar=a.photo_200)},n=0;n<e.data.response.items.length;n++)a(n);console.log(e.data.response.items),K(e.data.response.items)}),(function(e){console.log(e)})),console.log("dataUsers: ",P)}})).catch((function(e){console.log(e)})),b.a.get(ae("list.getGroups"),{}).then((function(e){if(e.data.error)console.log("\u041e\u0428\u0418\u0411\u041a\u0410 \u0414\u0410\u041d\u041d\u042b\u0425 \u0413\u0420\u0423\u041f\u041f:",e.data.error);else{for(var a=[],n=0;n<e.data.response.items.length;n++)e.data.response.items[n].id_group&&a.push(e.data.response.items[n].id_group);if(0===a.length)w(e.data.response.items),console.log("arrGroups:",a);else{var o=[];oe("groups.getById",{group_ids:a.join(),fields:"photo_200"},t.access_token,(function(t){o=t,console.log(t);for(var a=function(t){var a=o.find((function(a){return+a.id===+e.data.response.items[t].id_group}));console.log(a),a&&(e.data.response.items[t].name=a.name,e.data.response.items[t].avatar=a.photo_200)},n=0;n<e.data.response.items.length;n++)a(n);w(e.data.response.items)}),(function(e){console.log(e)})),console.log("dataGroups: ",T)}}})).catch((function(e){console.log(e)}));case 11:case"end":return a.stop()}}))}()}),[]);var le=function(e){e.preventDefault();var t=e.currentTarget.dataset.to;s(t),F(!1);var a=e.currentTarget.id-1;X(a),console.log("ID \u0414\u041e",a),ee(T[a].price),console.log("\u0426\u0415\u041d\u0410 \u041f\u041e\u0421\u041b\u0415",$)};return o.a.createElement(v.a,{activePanel:a,popout:re},o.a.createElement(J,{id:"list",fetchedUser:u,go:le,pay:ie,paymentStatus:E,activeTab:y,tabUsers:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:i.a.sendPromise("VKWebAppStorageSet",{key:"ActiveTab",value:"users"}).then((function(){i.a.sendPromise("VKWebAppStorageGet",{keys:["ActiveTab"]}).then((function(e){O(e.keys[0].value)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}))},tabGroups:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:i.a.sendPromise("VKWebAppStorageSet",{key:"ActiveTab",value:"groups"}).then((function(){i.a.sendPromise("VKWebAppStorageGet",{keys:["ActiveTab"]}).then((function(e){O(e.keys[0].value)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}))},dataUsers:P,dataGroups:T}),o.a.createElement(te,{id:"vkpay",go:le,pay:ie,onChangeHandlerInput:function(e){var t=e.target.value.trim().slice(15);i.a.sendPromise("VKWebAppCallAPIMethod",{method:"utils.resolveScreenName",request_id:"1",params:{screen_name:t,v:"5.103",access_token:M}}).then((function(e){void 0===e.response.object_id?F(!1):(N(e.response.object_id),F(!0)),console.log(e.response.object_id)})).catch((function(e){console.log(e)})),console.log("valueSlice: ",t)},reg:D,payGroups:function(e){e.preventDefault();var t=V;D?i.a.sendPromise("VKWebAppOpenPayForm",{app_id:7217737,action:"pay-to-group",params:{amount:$,group_id:189804850}}).then((function(e){(e.status||e.result.status)&&(k(!0),console.log("\u041e\u041f\u041b\u0410\u0422\u0410 \u041f\u0420\u041e\u0428\u041b\u0410 1"),b.a.get(ae("list.updateGroupsList"),{params:{id:Q+1,id_group:t}}).then((function(e){e.data.error?console.log(e.data.error):(console.log("Id_Group_updateGroupsList:",V),s("list"),console.log("\u041e\u041f\u041b\u0410\u0422\u0410 \u041f\u0420\u041e\u0428\u041b\u0410: 2",T))})).catch((function(e){console.log(e)})),i.a.sendPromise("VKWebAppCallAPIMethod",{method:"groups.getById",request_id:"1",params:{group_id:t,v:"5.103",access_token:M}}).then((function(e){console.log("res:",e);var a=e.response[0].name,n=e.response[0].photo_200,o=Object(l.a)(T);o[Q]=Object(m.a)({},o[Q],{id_group:t,name:a,avatar:n}),console.log("NAME:",a),console.log("AVATAR:",n),console.log("gu:",o),w(o)})).catch((function(e){console.log(e)}))),console.log(e.status)})).catch((function(e){console.log(e)})):console.log("\u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u0443 - \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0430\u044f",D)}}))};i.a.send("VKWebAppInit"),r.a.render(o.a.createElement(se,null),document.getElementById("root"))},22:function(e,t,a){e.exports={button:"ListUsers_button__3jVmk",div:"ListUsers_div__1sDxj",listNumber:"ListUsers_listNumber__29dNQ",listName:"ListUsers_listName__1YKFp"}},65:function(e,t,a){e.exports=a(122)}},[[65,1,2]]]);
//# sourceMappingURL=main.febeb275.chunk.js.map